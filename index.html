<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å‹•ç«ç®¡ç†ç³»çµ±</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Microsoft JhengHei', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
    .container { max-width: 800px; margin: 0 auto; }
    h1 { text-align: center; color: white; margin-bottom: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.2); }
    
    .sheet-link-container { text-align: center; margin-bottom: 25px; }
    .sheet-link-btn { display: inline-block; color: white; text-decoration: none; font-weight: bold; border: 1px solid rgba(255,255,255,0.6); padding: 8px 20px; border-radius: 50px; background: rgba(255,255,255,0.15); backdrop-filter: blur(5px); transition: all 0.3s; }
    .sheet-link-btn:hover { background: rgba(255,255,255,0.3); transform: translateY(-2px); }

    .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
    .tab { flex: 1; padding: 15px; background: rgba(255,255,255,0.9); border: none; border-radius: 10px 10px 0 0; cursor: pointer; font-weight: bold; }
    .tab.active { background: white; border-bottom: 4px solid #667eea; }
    
    .form-container { background: white; padding: 30px; border-radius: 0 0 15px 15px; display: none; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
    .form-container.active { display: block; }
    .form-group { margin-bottom: 20px; }
    label { display: block; margin-bottom: 8px; font-weight: bold; color: #333; }
    input, select { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; }
    .photo-upload { border: 2px dashed #ccc; padding: 20px; text-align: center; cursor: pointer; border-radius: 8px; }
    .photo-upload:hover { border-color: #667eea; background: #f8f9ff; }
    button.submit-btn { width: 100%; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-size: 1.2em; cursor: pointer; }
    .loading { display: none; text-align: center; color: #667eea; margin-top: 10px; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    
    /* æŸ¥è©¢è¡¨æ ¼èˆ‡åœ–ç¤º */
    .result-table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 0.9em; }
    .result-table th, .result-table td { border: 1px solid #ddd; padding: 10px; text-align: left; vertical-align: middle; }
    .result-table th { background: #f2f2f2; }
    .badge { padding: 4px 8px; border-radius: 4px; color: white; font-size: 0.85em; }
    .badge-pre { background: #48bb78; } .badge-during { background: #ed8936; } .badge-after { background: #4299e1; }
    .photo-icon { font-size: 1.5em; text-decoration: none; cursor: pointer; transition: transform 0.2s; display: inline-block; }
    .photo-icon:hover { transform: scale(1.2); }
    
    @media (max-width: 600px) {
      .row { grid-template-columns: 1fr; }
      .result-table, .result-table tr, .result-table td { display: block; }
      .result-table thead { display: none; }
      .result-table tr { margin-bottom: 10px; border: 1px solid #ccc; border-radius: 8px; }
      .result-table td { padding-left: 40%; position: relative; border: none; border-bottom: 1px solid #eee; }
      .result-table td:before { content: attr(data-label); position: absolute; left: 10px; font-weight: bold; width: 35%; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ”¥ å‹•ç«ç®¡ç†ç³»çµ±</h1>
    <div class="sheet-link-container">
      <a href="https://docs.google.com/spreadsheets/d/11p0DgmzBb3eBzAO8w8A5lR-vNGMFBMYyCOOzMwOe_W0/edit?gid=1052086617#gid=1052086617" target="_blank" class="sheet-link-btn">ğŸ“Š æŸ¥çœ‹ Google Sheet</a>
    </div>

    <div class="tabs">
      <button class="tab active" onclick="switchTab('pre')">å‹•ç«å‰</button>
      <button class="tab" onclick="switchTab('during')">å‹•ç«ä¸­</button>
      <button class="tab" onclick="switchTab('after')">å‹•ç«å¾Œ</button>
      <button class="tab" onclick="switchTab('query')">ä¸Šå‚³æŸ¥è©¢</button>
    </div>
    
    <div id="preFormContainer" class="form-container active">
      <form id="preForm">
        <div class="form-group"><label>å…¬å¸åç¨± *</label><select id="preCompany" required><option value="">è«‹é¸æ“‡</option></select></div>
        <div class="form-group"><label>å…¶ä»–å…¬å¸(è‹¥ä¸Šæ–¹é¸ã€Œå…¶ä»–ã€)</label><input type="text" id="preInputCompany"></div>
        <div class="form-group"><label>å·¥ç¨‹åç¨± *</label><select id="preProject" required><option value="">è«‹å…ˆé¸å…¬å¸</option></select></div>
        <div class="form-group"><label>å…¶ä»–å·¥ç¨‹(è‹¥ä¸Šæ–¹é¸ã€Œå…¶ä»–ã€)</label><input type="text" id="preInputProject"></div>
        
        <div class="form-group"><label>å·¥åœ°è² è²¬äºº *</label><input type="text" id="preManager" required placeholder="è«‹è¼¸å…¥å§“å"></div>
        
        <div class="form-group"><label>ä¸»è¾¦å–®ä½ *</label><input type="text" id="preDepartment" required></div>
        <div class="row">
          <div class="form-group"><label>é–‹å§‹æ™‚é–“ *</label><input type="datetime-local" id="preStartTime" required></div>
          <div class="form-group"><label>çµæŸæ™‚é–“ *</label><input type="datetime-local" id="preEndTime" required></div>
        </div>
        <div class="form-group"><label>å€åŸŸ *</label><select id="preArea" required><option value="">è«‹é¸æ“‡</option></select></div>
        <div class="form-group"><label>è©³ç´°ä½ç½®</label><input type="text" id="preLocation" required></div>
        <div class="form-group"><label>æ˜¯å¦ç‚ºé™åˆ¶å€åŸŸ?</label><select id="preRestricted" required><option value="">è«‹é¸æ“‡</option><option value="æ˜¯">æ˜¯</option><option value="å¦">å¦</option></select></div>
        <div class="form-group"><label>å‹•ç«é …ç›® *</label><select id="preItems" required><option value="">è«‹é¸æ“‡</option></select></div>
        
        <div class="form-group"><label>ç…§ç‰‡1ï¼šæ°£é«”åµæ¸¬å™¨ç…§ç‰‡</label><div class="photo-upload" onclick="document.getElementById('prePhoto1').click()">ğŸ“· ä¸Šå‚³å»ºè­°å¤§å°<5MB<input type="file" id="prePhoto1" accept="image/*" required></div><div id="prePhoto1Status"></div></div>
        <div class="form-group"><label>ç…§ç‰‡2ï¼šé˜²è­·è¨­å‚™ç…§ç‰‡</label><div class="photo-upload" onclick="document.getElementById('prePhoto2').click()">ğŸ“· ä¸Šå‚³å»ºè­°å¤§å°<5MB<input type="file" id="prePhoto2" accept="image/*" required></div><div id="prePhoto2Status"></div></div>
        
        <button type="submit" class="submit-btn">é€å‡º</button>
        <div id="preFormLoading" class="loading">â³ è™•ç†ä¸­...</div>
      </form>
    </div>
    
    <div id="duringFormContainer" class="form-container">
      <form id="duringForm">
        <div class="form-group"><label>å…¬å¸åç¨± *</label><select id="duringCompany" required></select></div>
        <div class="form-group"><label>å·¥ç¨‹åç¨± *</label><select id="duringProject" required></select></div>
        <div class="form-group"><label>æ˜¯å¦åˆ¤æ–·ã€ä½œæ¥­ç’°å¢ƒç¶“æª¢è¦–ç„¡é›œè‰ã€æ®˜æ²¹ç­‰æ½›åœ¨é¢¨éšªï¼Œç„¡é ˆé‹ªè¨­é˜²ç«æ¯¯ã€‘ï¼Ÿ
</label><select id="q1" required><option value="">è«‹é¸æ“‡</option><option value="æ˜¯">æ˜¯</option><option value="å¦">å¦</option></select></div>
        <div class="form-group"><label>ç…§ç‰‡1ï¼šå‹•ç«è¨±å¯è­‰</label><div class="photo-upload" onclick="document.getElementById('duringPhoto1').click()">ğŸ“· ä¸Šå‚³å»ºè­°å¤§å°<5MB<input type="file" id="duringPhoto1" accept="image/*" required></div><div id="duringPhoto1Status"></div></div>
        <div class="form-group"><label>ç…§ç‰‡2ï¼šç¾å ´å¯¦éš›é˜²è­·ä½œæ¥­ç‹€æ³</label><div class="photo-upload" onclick="document.getElementById('duringPhoto2').click()">ğŸ“· ä¸Šå‚³å»ºè­°å¤§å°<5MB<input type="file" id="duringPhoto2" accept="image/*" required></div><div id="duringPhoto2Status"></div></div>
        <button type="submit" class="submit-btn">é€å‡º</button>
        <div id="duringFormLoading" class="loading">â³ è™•ç†ä¸­...</div>
      </form>
    </div>

    <div id="afterFormContainer" class="form-container">
      <form id="afterForm">
        <div class="form-group"><label>å…¬å¸åç¨± *</label><select id="afterCompany" required></select></div>
        <div class="form-group"><label>å·¥ç¨‹åç¨± *</label><select id="afterProject" required></select></div>
        <div class="form-group"><label>ä½œæ¥­çµæŸæ™‚é–“ *</label><input type="datetime-local" id="qTime" required></div>
        <div class="form-group"><label>æ˜¯å¦ç¢ºå®šã€å·²å®Œæˆç’°å¢ƒæ¸…ç†ç„¡æ®˜ç•™ç«æ˜Ÿã€‘</label><select id="qYesNo" required><option value="">è«‹é¸æ“‡</option><option value="æ˜¯">æ˜¯</option><option value="å¦">å¦</option></select></div>
        <div class="form-group"><label>ç…§ç‰‡1ï¼šå‹•ç«ä½œæ¥­è‡ªä¸»æª¢æŸ¥è¡¨</label><div class="photo-upload" onclick="document.getElementById('afterPhoto1').click()">ğŸ“· ä¸Šå‚³å»ºè­°å¤§å°<5MB<input type="file" id="afterPhoto1" accept="image/*" required></div><div id="afterPhoto1Status"></div></div>
        <div class="form-group"><label>ç…§ç‰‡2ï¼šç¾å ´æ¢å¾©ç…§ç‰‡</label><div class="photo-upload" onclick="document.getElementById('afterPhoto2').click()">ğŸ“· ä¸Šå‚³å»ºè­°å¤§å°<5MB<input type="file" id="afterPhoto2" accept="image/*"required></div><div id="afterPhoto2Status"></div></div>
        <button type="submit" class="submit-btn">é€å‡º</button>
        <div id="afterFormLoading" class="loading">â³ è™•ç†ä¸­...</div>
      </form>
    </div>

    <div id="queryFormContainer" class="form-container">
      <div class="form-group"><label>æŸ¥è©¢æ—¥æœŸ (é¸å¡«) *</label><input type="date" id="queryDate"></select></div>
      <div class="form-group"><label>å…¬å¸åç¨± (é¸å¡«)</label><select id="queryCompany"></select></div>
      <button type="button" class="submit-btn" onclick="searchRecords()">ğŸ” æŸ¥è©¢</button>
      <div id="queryLoading" class="loading">â³ æŸ¥è©¢ä¸­...</div>
      <div id="queryResults"></div>
    </div>
  </div>
  
  <script>
    function switchTab(t) {
      document.querySelectorAll('.tab').forEach(e=>e.classList.remove('active')); event.target.classList.add('active');
      document.querySelectorAll('.form-container').forEach(e=>e.classList.remove('active')); document.getElementById(t+'FormContainer').classList.add('active');
    }
  </script>
  <script src="script.js"></script>
</body>

</html>



